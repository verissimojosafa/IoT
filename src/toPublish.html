<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>MQTT conection</title>
  </head>
  <body>
    <div id="connecting">
      estabelencendo conex√£o...
    </div>

    <div id="connected" hidden>
    <h1>Publish message</h1>
      <form onsubmit="sendMessage(event)">
          <label for="form-payload">Message</label>
          <input id="form-payload" type="text" name="payload">
  
          <label for="form-topics">Topic</label>
          <input id="form-topics" type="text" name="topic">
          <input type="submit" value="submit">
      </form>
    </div>

    <footer>
      <script src="../public/js/PahoMqtt.js"></script>
      <script src="../public/js/MqttConnection.js"></script>
      <script src="../public/js/publisher.js"></script>

      <script>
        function connectionEstablished() {
          document.querySelector('#connecting').remove();
          document.querySelector('#connected').removeAttribute('hidden');
        }

        function sendMessage(event) {
          event.preventDefault();

          const data = {
            payload: event.target.payload.value,
            topic: event.target.topic.value
          }

          sendToBroker(data);
        }
      </script>
    </footer>
  </body>
</html>
