<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>MQTT conection</title>

    <link rel="stylesheet" href="../public/css/normalize.css">
    <link rel="stylesheet" href="../public/css/styles.css">
  </head>
  <body>
    <div id="connecting">
      estabelencendo conex√£o...
    </div>

    <div id="connected" hidden>
      <header>
        <h1>Publish message</h1>
      </header>

      <main>
        <div class="toCenter">
          <form onsubmit="sendMessage(event)">
              <input id="form-payload" type="text" name="payload" placeholder="message" required>
              <input id="form-topics" type="text" name="topic" placeholder="topic" required>

              <input type="submit" value="submit">
          </form>
        </div>
      </main>
    </div>

    <footer>
      <script src="../public/js/PahoMqtt.js"></script>
      <script src="../public/js/MqttConnection.js"></script>
      <script src="../public/js/publisher.js"></script>

      <script>
        function connectionEstablished() {
          document.querySelector('#connecting').remove();
          document.querySelector('#connected').removeAttribute('hidden');
        }

        function sendMessage(event) {
          event.preventDefault();

          const data = {
            payload: event.target.payload.value,
            topic: event.target.topic.value
          }

          sendToBroker(data);
        }
      </script>
    </footer>
  </body>
</html>
